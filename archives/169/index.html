<!DOCTYPE HTML>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,ç†ŠçŒ«å°A,Galileo,blog" />
    <meta name="generator" content="Maverick 1.1" />
    <meta name="template" content="Prism" />
    <link rel="alternate" type="application/rss+xml" title="æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’ &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’ &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/prism-b9d78ff38a.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/ExSearch-182e5a8869.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/993aa3dcb70943b3e506b13b3d502541.json"
        }

    </script>
    
<title>ä¸€äº› Typecho å¼€å‘ç¬”è®° - æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’</title>
<meta name="author" content="ç†ŠçŒ«å°A" />
<meta name="description" content="æŸäº›ç»éªŒæ€§è´¨çš„ä¸œè¥¿ä¸å†™ä¸‹æ¥å¾ˆå¿«å°±ä¼šå¿˜ï¼Œæ‰€ä»¥æœ‰äº†è¿™ä¸€ç¯‡å¤‡å¿˜ã€‚" />
<meta property="og:title" content="ä¸€äº› Typecho å¼€å‘ç¬”è®° - æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’" />
<meta property="og:description" content="æŸäº›ç»éªŒæ€§è´¨çš„ä¸œè¥¿ä¸å†™ä¸‹æ¥å¾ˆå¿«å°±ä¼šå¿˜ï¼Œæ‰€ä»¥æœ‰äº†è¿™ä¸€ç¯‡å¤‡å¿˜ã€‚" />
<meta property="og:site_name" content="æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/169/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2018-10-18T22:34:00-00.00" />
<meta name="twitter:title" content="ä¸€äº› Typecho å¼€å‘ç¬”è®° - æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’" />
<meta name="twitter:description" content="æŸäº›ç»éªŒæ€§è´¨çš„ä¸œè¥¿ä¸å†™ä¸‹æ¥å¾ˆå¿«å°±ä¼šå¿˜ï¼Œæ‰€ä»¥æœ‰äº†è¿™ä¸€ç¯‡å¤‡å¿˜ã€‚" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />


    
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
<link rel="dns-prefetch" href="//blog.imalan.cn" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/brand_font/embed.css" />
<style>.brand{font-family:FZCuJinLFW,serif;font-weight: normal!important;}</style>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/apple-touch-icon.png?v=PY43YeeEKx">
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon-32x32.png?v=yyLyaqbyRG">
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon-16x16.png?v=yyLyaqbyRG">
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/safari-pinned-tab.svg?v=yyLyaqbyRG" color="#505050">
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon.ico?v=yyLyaqbyRG">
<meta name="application-name" content="ä¸‰ç„¡è¨ˆåŠƒ">
<meta name="apple-mobile-web-app-title" content="ä¸‰ç„¡è¨ˆåŠƒ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="theme-color" content="#000000">
<meta name="baidu-site-verification" content="9BEwwo6Ibg" />

</head>

<body>
    <div class="container prism-container">
        <header class="prism-header" id="prism__header">
            <h1 class="text-uppercase brand"><a class="no-link" href="/" target="_self">æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’</a></h1>
            <p>åªåšæŒä¸€ç§æ­£ä¹‰ã€‚æˆ‘çš„æ­£ä¹‰ã€‚</p>
            <nav class="prism-nav"><ul><li><a class="no-link text-uppercase " href="/" target="_self">é¦–é¡µ</a></li><li><a class="no-link text-uppercase " href="/archives/" target="_self">å½’æ¡£</a></li><li><a class="no-link text-uppercase " href="/links/" target="_self">å‹é“¾</a></li><li><a class="no-link text-uppercase " href="/about/" target="_self">å…³äº</a></li><li><a href="#" target="_self" class="search-form-input no-link text-uppercase">æœç´¢</a></li></ul></nav>
        </header>
        <div class="prism-wrapper" id="prism__wrapper">
            
<main>
    <section class="prism-section row" id="prism__content">
        <article class="yue col-md-8 offset-md-2">
            <h1 class="prism-post-title">ä¸€äº› Typecho å¼€å‘ç¬”è®°</h1>
            <div class="prism-post-time">
                <time class="text-uppercase">
                    October 18 2018
                </time>
            </div>
            <div class="prism-content-body">
                <p>æœ€è¿‘åšäº†ä¸¤ä¸ªä¸»é¢˜ï¼Œä¸€ä¸ªæ˜¯ <a href="https://github.com/AlanDecode/Typecho-Theme-RAW">Typecho-Theme-RAW</a>ï¼Œå¦ä¸€ä¸ªå°±æ˜¯ç°åœ¨ä½¿ç”¨çš„è¿™ä¸ªï¼ŒTypecho-Theme-Qã€‚RAW æ˜¯æˆ‘çš„ Typecho ä¸»é¢˜ç¬¬ä¸€ä½œï¼Œè±¡å¾æ„ä¹‰æ¯”è¾ƒå¤§ä¸€ç‚¹ï¼Œä¸»é¢˜è´¨é‡å„æ–¹é¢åªèƒ½ç®—å·®å¼ºäººæ„å§ã€‚Q çš„èµ·æºæ˜¯å› ä¸ºæˆ‘è§‰å¾— Bootstrap æœ‰ç‚¹æ„æ€ï¼Œè¾¹çœ‹æ–‡æ¡£è¾¹å†™å°±å†™å‡ºæ¥äº†ï¼Œç”±äºæœ‰å†™ RAW æ—¶ç§¯ç´¯çš„ç»éªŒåŠ æŒï¼Œå®Œæˆå¾—å¾ˆå¿«ã€‚æŸäº›ç»éªŒæ€§è´¨çš„ä¸œè¥¿ä¸å†™ä¸‹æ¥å¾ˆå¿«å°±ä¼šå¿˜ï¼Œæ‰€ä»¥æœ‰äº†è¿™ä¸€ç¯‡å¤‡å¿˜ã€‚</p>
<blockquote><p>ä»¥ä¸‹éƒ¨åˆ†å†…å®¹æ¥è‡ª <a href="https://qqdie.com">QQ çˆ¹åšå®¢</a>ç­‰å¤§ä½¬çš„åšæ–‡ï¼Œåœ¨æ­¤å…ˆè¡Œæ„Ÿè°¢ã€‚</p>
</blockquote>
<h2>Typecho é…ç½®</h2>
<h3>TYPECHO_DEBUG</h3>
<p>å¯åœ¨ Typecho æ ¹ç›®å½•ä¸‹ <code>config.inc.php</code> ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç æ¥å¼€å¯ DEBUG æ¨¡å¼ã€‚</p>
<div class="highlight"><pre><span></span><span class="x">define(&#39;__TYPECHO_DEBUG__&#39;, true);</span>
</pre></div>
<p>è¿™ä¸ªæ¨¡å¼ä¸‹ä¼šæ‰“å°æ›´å¤šçš„æŠ¥é”™ä¿¡æ¯ï¼ŒæŸäº›æ™®é€šæƒ…å†µç›´æ¥ 500 å¤„ç†çš„é”™è¯¯åœ¨è¿™é‡Œä¼šæ‰“å°å‡ºé”™è¯¯åŸå› ä¸è°ƒç”¨å †æ ˆç­‰ï¼Œå¾ˆæœ‰ç”¨ã€‚</p>
<h3>TYPECHO_GRAVATR_PREFIX</h3>
<p>è¿™ä¸ªå¸¸é‡å¯ä»¥ä¿®æ”¹ GRAVATAR å¤´åƒé“¾æ¥çš„å‰ç¼€ï¼Œæ–¹ä¾¿ä½¿ç”¨å›½å†…é•œåƒæ¥åŠ å¿«é€Ÿåº¦ã€‚</p>
<div class="highlight"><pre><span></span><span class="x">define(&#39;__TYPECHO_GRAVATR_PREFIX__&#39;, &#39;https://gravatar.cat.net/avatar&#39;);</span>
</pre></div>
<p>éœ€è¦æ³¨æ„çš„æ˜¯è¦ç”Ÿæ•ˆçš„è¯éœ€è¦åœ¨ä¸»é¢˜ä¸­ä½¿ç”¨ Typecho æä¾›çš„æ–¹æ³•æ¥è·å–å¤´åƒé“¾æ¥ã€‚</p>
<h3>ä¸»é¢˜å±‚é¢ä¿®æ”¹ Typecho è®¾ç½®</h3>
<p>åœ¨ PJAX ä¸­è¯„è®ºå¤±æ•ˆçš„é—®é¢˜éœ€è¦å…³é—­ä¸»é¢˜çš„ååƒåœ¾ä¿æŠ¤ï¼Œåœ¨ä¸»é¢˜ä¸­å¯ä»¥è‡ªåŠ¨åšåˆ°è¿™ä¸€ç‚¹ã€‚åœ¨ä¸»é¢˜ç›®å½•ä¸‹ <code>functions.php</code> ä¸­åˆ›å»ºå¦‚ä¸‹ä»£ç å³å¯ã€‚</p>
<div class="highlight"><pre><span></span><span class="x">function themeInit($archive){</span>
<span class="x">    Helper::options()-&gt;commentsAntiSpam = false; </span>
<span class="x">}</span>
</pre></div>
<p>Typecho ç³»ç»Ÿè®¾ç½®å‡å¯ä½¿ç”¨ <code>Helper::options()</code> å‡½æ•°è·å–ï¼Œæƒé™è›®é«˜çš„ã€‚å¦ï¼š<code>themeInit()</code> å‡½æ•°å®Œæˆäº†ä¸»é¢˜åˆå§‹åŒ–ï¼Œåˆ›å»ºè¡¨ä¹‹ç±»çš„æ“ä½œå¯ä»¥åœ¨è¿™ä¸ªå‡½æ•°ä¸­å®Œæˆã€‚</p>
<h2>ä¸»é¢˜å¼€å‘</h2>
<h3>è‡ªå®šä¹‰æ¸²æŸ“æ–¹å¼</h3>
<p>åˆ†åˆ«åˆ›å»º <code>category</code>ï¼Œ<code>page</code>ï¼Œ<code>post</code> æ–‡ä»¶å¤¹ï¼Œåœ¨å…¶ä¸­åˆ›å»º <code>åˆ†ç±»ç¼©ç•¥å.php</code>ã€<code>é¡µé¢slug.php</code>ã€<code>æ–‡ç« cid.php</code> å³å¯è¦†ç›–é»˜è®¤çš„æ¸²æŸ“æ–¹å¼æ¥ä¸ºæŸåˆ†ç±»ã€é¡µé¢ã€æ–‡ç« åˆ›å»ºè‡ªå®šä¹‰æ¸²æŸ“æ–¹å¼ã€‚</p>
<h3>ä¸»é¢˜è®¾ç½®é¢æ¿</h3>
<p>åœ¨ä¸»é¢˜æ ¹ç›®å½•ä¸‹åˆ›å»º <code>functions.php</code>ï¼Œåœ¨å…¶ä¸­å®šä¹‰å‡½æ•° <code>themeConfig($form)</code></p>
<div class="highlight"><pre><span></span><span class="x">function themeConfig($form) {</span>
<span class="x">    //åŸºæœ¬è®¾ç½®</span>
<span class="x">    $notice = new Typecho_Widget_Helper_Form_Element_Textarea(&#39;notice&#39;, NULL, NULL, _t(&#39;ç½‘ç«™å…¬å‘Š&#39;), _t(&#39;ç½‘ç«™å…¬å‘Š&#39;));</span>
<span class="x">    $form-&gt;addInput($notice);</span>
<span class="x">    $banner = new Typecho_Widget_Helper_Form_Element_Text(&#39;banner&#39;, NULL, NULL, _t(&#39;ç½‘ç«™å…¬å‘Š&#39;), _t(&#39;ç½‘ç«™å…¬å‘Š&#39;));</span>
<span class="x">    $form-&gt;addInput($banner);</span>
<span class="x">}</span>
</pre></div>
<p>ç±»ä¼¼è¿™æ ·å°±å¯ä»¥æ·»åŠ  Textarea æˆ–è€… Text ç±»å‹çš„è¾“å…¥æ¡†ã€‚å…¶ä¸­çš„å†…å®¹åœ¨ä¸»é¢˜ä¸­å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æ¥è®¿é—®ã€‚</p>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;options-&gt;ValueName</span>
</pre></div>
<h3>æ–‡ç« è‡ªå®šä¹‰å­—æ®µé¢æ¿</h3>
<p>åœ¨ä¸»é¢˜æ ¹ç›®å½•ä¸‹åˆ›å»º <code>functions.php</code>ï¼Œåœ¨å…¶ä¸­å®šä¹‰å‡½æ•°</p>
<div class="highlight"><pre><span></span><span class="x">function themeFields(Typecho_Widget_Helper_Layout $layout) {</span>
<span class="x">    $thumb = new Typecho_Widget_Helper_Form_Element_Textarea(&#39;banner&#39;, NULL, NULL, &#39;æ–‡ç« ä¸»å›¾&#39;, &#39;è¾“å…¥å›¾ç‰‡URLï¼Œè¯¥å›¾ç‰‡ä¼šç”¨äºä¸»é¡µæ–‡ç« åˆ—è¡¨çš„æ˜¾ç¤º&#39;);</span>
<span class="x">    $layout-&gt;addItem($thumb);</span>
<span class="x">    $showTOC=new Typecho_Widget_Helper_Form_Element_Select(&#39;showTOC&#39;,array(&#39;0&#39;=&gt;&#39;ä¸æ˜¾ç¤ºç›®å½•&#39;,&#39;1&#39;=&gt;&#39;æ˜¾ç¤ºç›®å½•&#39;),&#39;0&#39;,&#39;æ–‡ç« ç›®å½•&#39;,&#39;æ˜¯å¦æ˜¾ç¤ºæ–‡ç« ç›®å½•&#39;);</span>
<span class="x">    $layout-&gt;addItem($showTOC);</span>
<span class="x">}</span>
</pre></div>
<p>ä¸ä¸Šé¢ç›¸ä¼¼ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ºè‡ªå®šä¹‰å­—æ®µåˆ›å»ºå‹å¥½çš„è¾“å…¥æ–¹å¼ã€‚è¿™ä¸æ‰‹åŠ¨æ·»åŠ è‡ªå®šä¹‰å­—æ®µæ˜¯ç­‰æ•ˆçš„ï¼Œä½†æ˜¯å¯ä»¥æé«˜ä½¿ç”¨ä½“éªŒã€‚</p>
<h3>è‡ªå®šä¹‰è¯„è®ºè¾“å‡ºæ–¹å¼</h3>
<p>åˆ›å»º <code>comments.php</code> æ–‡ä»¶ï¼Œrequire åœ¨ <code>functions.php</code> ä¸­ï¼Œç„¶åå°±å¯ä»¥åœ¨å…¶ä¸­é‡è½½è¾“å‡ºè¯„è®ºçš„æ–¹å¼ã€‚</p>
<h3>Typecho å†…å»ºå‡½æ•°</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;header();</span>
</pre></div>
<p>è¿™ä¸ªå‡½æ•°è¦åœ¨ <code>head</code> æ ‡ç­¾ä¸­è°ƒç”¨ï¼Œè´Ÿè´£è¾“å‡º RSSã€Pingback ç­‰ä¿¡æ¯ï¼Œè¿˜æ¶‰åŠè¾“å‡ºæ’ä»¶è¦åœ¨ <code>head</code> ä¸­è¾“å‡ºçš„å†…å®¹ã€‚ä¸ä¸Šé¢çš„ç±»ä¼¼ï¼Œä¸è¿‡ä¸€èˆ¬åœ¨ <code>footer</code> æ ‡ç­¾åè°ƒç”¨ï¼š</p>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;footer();</span>
</pre></div>
<p>è·å–æ‰€æœ‰è®¾ç½®ï¼š</p>
<div class="highlight"><pre><span></span><span class="x">Helper::options();</span>
</pre></div>
<p>è·å–æŸæ’ä»¶è®¾ç½®ï¼š</p>

<pre><code>Helper::options()-&gt;plugin($pluginName);</code></pre>
<h2>å¸¸ç”¨ä»£ç ç‰‡æ®µ</h2>
<h3>åšå®¢å†…å®¹ç»Ÿè®¡</h3>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="nx">Typecho_Widget</span><span class="o">::</span><span class="na">widget</span><span class="p">(</span><span class="s1">&#39;Widget_Stat&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="nv">$stat</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;li&gt;æ–‡ç« æ€»æ•°ï¼š</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedPostsNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">ç¯‡&lt;/li&gt;</span>
<span class="x">&lt;li&gt;åˆ†ç±»æ€»æ•°ï¼š</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">categoriesNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">ä¸ª&lt;/li&gt;</span>
<span class="x">&lt;li&gt;è¯„è®ºæ€»æ•°ï¼š</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedCommentsNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">æ¡&lt;/li&gt;</span>
<span class="x">&lt;li&gt;é¡µé¢æ€»æ•°ï¼š</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedPagesNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">ä¸ª&lt;/li&gt;</span>
</pre></div>
<h3>è¾“å‡ºå½“å‰æ–‡ç« ä¸ºç¬¬å‡ ç¯‡</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;sequence</span>
</pre></div>
<h3>æœ€è¿‘è¯„è®º</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;widget(&#39;Widget_Comments_Recent&#39;,&#39;ignoreAuthor=true&amp;pageSize=10&#39;)-&gt;to($comments);</span>
<span class="cp">&lt;?php</span> <span class="k">while</span><span class="p">(</span><span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">())</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">gravatar</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">permalink</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">excerpt</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/a&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endwhile</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>å…¶ä¸­ <code>ignoreAuthor=true</code> å¯ä»¥è¿‡æ»¤æ‰åšä¸»è‡ªå·±çš„è¯„è®ºã€‚<code>pageSize</code> ä¸ºè¾“å‡ºæ•°é‡ã€‚</p>
<h3>Gravatar å¤´åƒé“¾æ¥</h3>
<div class="highlight"><pre><span></span><span class="x">Typecho_Common::gravatarUrl($mail, $size, &#39;&#39;, &#39;&#39;, true);</span>
</pre></div>
<p>å¯ä»¥æ ¹æ®é‚®ç®±åœ°å€ç»™å‡ºå¤´åƒé“¾æ¥ã€‚</p>
<h3>è¾“å‡ºæ‰€æœ‰ç‹¬ç«‹é¡µé¢</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;widget(&#39;Widget_Contents_Page_List&#39;)-&gt;parse(&#39;&lt;li&gt;&lt;a href=&quot;{permalink}&quot; target=&quot;_self&quot;&gt;{title}&lt;/a&gt;&lt;/li&gt;&#39;);</span>
</pre></div>
<p><code>parse</code> æ–¹æ³•å¯ä»¥éå¸¸æ–¹ä¾¿åœ°æ ¼å¼åŒ–è¾“å‡ºæ‰€æœ‰çš„ç‹¬ç«‹é¡µé¢ï¼Œå¤ªå¸…äº†ã€‚</p>
<h3>æ–‡ç« ã€è¯„è®ºåˆ†é¡µ</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;pageNav(&#39;ä¸Šä¸€é¡µ&#39;, &#39;ä¸‹ä¸€é¡µ&#39;, 0, &#39;&#39;, &#39;wrapClass=hidden&amp;prevClass=prev&amp;nextClass=next&#39;);</span>
</pre></div>
<h3>åˆ¤æ–­æ’ä»¶æ˜¯å¦å¯ç”¨</h3>
<p>è¿™æ˜¯ä¸€ä¸ªå°å‘ã€‚åªè¦å¯ç”¨è¿‡æ’ä»¶ï¼Œå³ä½¿å·²ç»ç¦ç”¨äº†æ’ä»¶ï¼Œ<code>class_exsist()</code> ä»ç„¶ä¼šè¿”å› <code>true</code>ï¼Œæ‰€ä»¥åº”è¯¥å¦‚ä¸‹æ£€éªŒï¼š</p>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * åˆ¤æ–­æ’ä»¶æ˜¯å¦å­˜åœ¨å¹¶å¯ç”¨</span>
<span class="x"> * </span>
<span class="x"> * @return boolean</span>
<span class="x"> */</span>
<span class="x">function isPluginAvailable($name) {</span>
<span class="x">    if (class_exists($name.&#39;_Plugin&#39;)){</span>
<span class="x">        $plugins = Typecho_Plugin::export();</span>
<span class="x">        $plugins = $plugins[&#39;activated&#39;];</span>
<span class="x">        return is_array($plugins) &amp;&amp; array_key_exists($name, $plugins);</span>
<span class="x">    }</span>
<span class="x">    return false;</span>
<span class="x">}</span>
</pre></div>
<h3>æ ¡éªŒè¯·æ±‚æ˜¯å¦æ¥è‡ªæ‰‹æœº</h3>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * æ‰‹æœºè¯†åˆ«</span>
<span class="x"> * </span>
<span class="x"> * @return boolean</span>
<span class="x"> */</span>
<span class="x">function isPhone(){</span>
<span class="x">    $ua=strtolower($_SERVER[&quot;HTTP_USER_AGENT&quot;]);</span>
<span class="x">    $devices=array(&quot;Android&quot;, &#39;iPhone&#39;, &#39;iPod&#39;, &#39;Phone&#39;);</span>
<span class="x">    foreach ($devices as $device) {</span>
<span class="x">        if(strpos($ua, strtolower($device))){</span>
<span class="x">            return true;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    return false;</span>
<span class="x">}</span>
</pre></div>
<h3>æ ¡éªŒè¯·æ±‚æ˜¯å¦æ¥è‡ªç§»åŠ¨è®¾å¤‡</h3>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * ç§»åŠ¨ç«¯åˆ¤å®š</span>
<span class="x"> * </span>
<span class="x"> * @return bool</span>
<span class="x"> */</span>
<span class="x">public static function isMobile(){ </span>
<span class="x">    if (isset ($_SERVER[&#39;HTTP_X_WAP_PROFILE&#39;])){</span>
<span class="x">        return TRUE;</span>
<span class="x">    }</span>

<span class="x">    if (isset ($_SERVER[&#39;HTTP_USER_AGENT&#39;])) {</span>
<span class="x">        $clientkeywords = array (&#39;mobile&#39;,&#39;nokia&#39;,&#39;sony&#39;,&#39;ericsson&#39;,&#39;mot&#39;,&#39;samsung&#39;,&#39;htc&#39;,&#39;sgh&#39;,&#39;lg&#39;,&#39;sharp&#39;,&#39;sie-&#39;,&#39;philips&#39;,&#39;panasonic&#39;,&#39;alcatel&#39;,&#39;lenovo&#39;,&#39;iphone&#39;,&#39;ipod&#39;,&#39;blackberry&#39;,&#39;meizu&#39;,&#39;android&#39;,&#39;netfront&#39;,&#39;symbian&#39;,&#39;ucweb&#39;,&#39;windowsce&#39;,&#39;palm&#39;,&#39;operamini&#39;,&#39;operamobi&#39;,&#39;openwave&#39;,&#39;nexusone&#39;,&#39;cldc&#39;,&#39;midp&#39;,&#39;wap&#39;</span>
<span class="x">            ); </span>
<span class="x">        if (preg_match(&quot;/(&quot; . implode(&#39;|&#39;, $clientkeywords) . &quot;)/i&quot;, strtolower($_SERVER[&#39;HTTP_USER_AGENT&#39;]))){</span>
<span class="x">            return TRUE;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    if (isset ($_SERVER[&#39;HTTP_ACCEPT&#39;])){</span>
<span class="x">        if ((strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;vnd.wap.wml&#39;) !== FALSE) &amp;&amp; (strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;text/html&#39;) === FALSE || (strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;vnd.wap.wml&#39;) &lt; strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;text/html&#39;)))){</span>
<span class="x">            return TRUE;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    return FALSE;</span>
<span class="x">}</span>
</pre></div>
<h3>è¾“å‡ºå®Œå¤‡çš„æ–‡ç« æ ‡é¢˜</h3>
<p>ä¸€èˆ¬æ˜¯å¤„äº SEO ä¹‹ç”¨</p>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * å¯¼å‡ºæ ‡é¢˜</span>
<span class="x"> * </span>
<span class="x"> * @return void</span>
<span class="x"> */</span>
<span class="x">function title(Widget_Archive $archive){</span>
<span class="x">    $archive-&gt;archiveTitle(array(</span>
<span class="x">        &#39;category&#39;  =&gt;  _t(&#39;åˆ†ç±» %s ä¸‹çš„æ–‡ç« &#39;),</span>
<span class="x">        &#39;search&#39;    =&gt;  _t(&#39;åŒ…å«å…³é”®å­— %s çš„æ–‡ç« &#39;),</span>
<span class="x">        &#39;tag&#39;       =&gt;  _t(&#39;æ ‡ç­¾ %s ä¸‹çš„æ–‡ç« &#39;),</span>
<span class="x">        &#39;author&#39;    =&gt;  _t(&#39;%s å‘å¸ƒçš„æ–‡ç« &#39;)</span>
<span class="x">    ), &#39;&#39;, &#39; - &#39;);</span>
<span class="x">    Helper::options()-&gt;title();</span>
<span class="x">}</span>
</pre></div>
<h3>é¢åŒ…å±‘å¯¼èˆª</h3>
<p>ç”¨ä»¥è¾“å‡ºå½“å‰ä½ç½®ç›¸å¯¹ä¸»é¡µçš„è·¯ç”±ã€‚</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- é¡µé¢ä¸ºé¦–é¡µæ—¶ --&gt;</span>
<span class="x">    æ–‡ç« åˆ—è¡¨ &amp;raquo; ç¬¬&amp;nbsp;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_currentPage</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;nbsp;é¡µ</span>
<span class="cp">&lt;?php</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- é¡µé¢ä¸ºæ–‡ç« å•é¡µæ—¶ --&gt;</span>
<span class="x">    æ–‡ç«  &amp;raquo; </span><span class="cp">&lt;?php</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="k">else</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- é¡µé¢ä¸ºå…¶ä»–é¡µæ—¶ --&gt;</span>
<span class="cp">&lt;?php</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">archiveTitle</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;category&#39;</span>  <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;åˆ†ç±» &quot;%s&quot; ä¸‹çš„æ–‡ç« &#39;</span><span class="p">),</span>
    <span class="s1">&#39;search&#39;</span>    <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;åŒ…å«å…³é”®å­— &quot;%s&quot; çš„æ–‡ç« &#39;</span><span class="p">),</span>
    <span class="s1">&#39;tag&#39;</span>       <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;æ ‡ç­¾ &quot;%s&quot; ä¸‹çš„æ–‡ç« &#39;</span><span class="p">),</span>
    <span class="s1">&#39;author&#39;</span>    <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;%s å‘å¸ƒçš„æ–‡ç« &#39;</span><span class="p">)</span>
<span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<h3>æŸäº›å¯ä»¥ç®€åŒ–å·¥ä½œé‡çš„å‡½æ•°</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;options-&gt;themeUrl(&#39;/some/path/&#39;); //è¾“å‡ºç›¸å¯¹ä¸»é¢˜ç›®å½•çš„è·¯å¾„</span>
<span class="x">Helper::options()-&gt;pluginUrl; //è·å–æ’ä»¶ç›®å½•</span>
<span class="x">Helper::options()-&gt;index(&#39;/some/path/&#39;); //è¾“å‡ºç›¸å¯¹åšå®¢æ ¹ç›®å½•çš„è·¯å¾„</span>
</pre></div>
<h2>æ•°æ®åº“ç›¸å…³</h2>
<h3>æ ¹æ® CID è°ƒç”¨æ–‡ç« </h3>
<div class="highlight"><pre><span></span><span class="x">$db = Typecho_Db::get();</span>
<span class="x">$row = $db-&gt;fetchRow($db-&gt;select()-&gt;from(&#39;table.contents&#39;)-&gt;where(&#39;cid = ?&#39;, $cid));</span>
</pre></div>
<p><code>$row</code> ä¸º Arrayï¼ŒåŒ…æ‹¬äº†æ–‡ç« æœ¬é¢˜çš„è®¸å¤šå­—æ®µï¼ŒåŒ…æ‹¬ <code>title</code>ã€åˆ›å»ºæ—¥æœŸç­‰ã€‚</p>
<h3>è·å¾—æŸæ–‡ç« çš„æŸè‡ªå®šä¹‰å­—æ®µ</h3>
<div class="highlight"><pre><span></span><span class="x">$row = $db-&gt;fetchAll($db-&gt;select()-&gt;from(&#39;table.fields&#39;)-&gt;where(&#39;cid = ?&#39;, $cid)-&gt;where(&#39;name = ?&#39;, $fieldName));</span>
<span class="x">$field=$row[0][&#39;str_value&#39;];</span>
</pre></div>
<p>æ•°æ®åº“ç›¸å…³å±äºæ¯”è¾ƒé«˜çº§çš„ç”¨æ³•äº†ï¼Œè™½ç„¶åœ¨æŸäº›æ—¶å€™ä¸å¾—ä¸ç”¨ï¼Œä½†æ˜¯æœ€å¥½è¿˜æ˜¯ä½¿ç”¨ Typecho æä¾›çš„æ›´åŸç”Ÿçš„æ–¹æ³•ã€‚æ›´å¤šï¼š<a href="https://qqdie.com/archives/typecho-database-api.html">Typechoæ•°æ®åº“å¸¸ç”¨API</a> ã€‚</p>
<p>æš‚æ—¶å°±è¿™äº›ï¼Œåç»­æƒ³åˆ°å†æ·»åŠ ã€‚</p>

            </div>
        </article>
        <div class="prism-post-meta col-md-8 offset-md-2">
    <span>ç†ŠçŒ«å°A</span>
    
    <span>/</span>
    <span>
        <a class="category no-link" href="/category/å¶å°”Geek/" target="_self">
        å¶å°”Geek
        </a>
    </span>
    
    
    
    <span>/</span>
    <span class="leancloud_visitors" id="/archives/169/" data-flag-title="ä¸€äº› Typecho å¼€å‘ç¬”è®°"><span class="leancloud-visitors-count"></span> Views</span>
    
</div>
    </section>

    
<section id="prism__pagination" class="prism-pagination" class="col-md-8 offset-md-2">
    <ul>
        
        <li class="next">
            <a class="no-link" href="/archives/171/" target="_self" title="è®©ç‚®å§è·Ÿç€æˆ‘è·‘ - ç¼“åŠ¨è·Ÿéš Demo"><i class="fa fa-chevron-left" aria-hidden="true"></i>æ›´æ–°</a>
        </li>
        
        
        <li class="prev">
            <a class="no-link" href="/archives/168/" target="_self" title="Typecho-Plugin-DoubanBoard å‘å¸ƒ">æ›´æ—§<i class="fa fa-chevron-right" aria-hidden="true"></i></a>
        </li>
        
    </ul>
</section>


    
    <script>
        var initValine = function() {
            new Valine({"enable": true, "el": "#vcomments", "appId": "6chFXPTjrjYnjFk9duROcboN-gzGzoHsz", "appKey": "c1CRooaFmpLs4xi7x3YLm3ma", "visitor": true, "recordIP": true, "placeholder": "\u6765\u7545\u6240\u6b32\u8a00\u5427~"});
        }

    </script>
    <script defer src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js' onload="initValine()"></script>
    <div class="prism-comment-section container" id="prism__comment">
        <div class="row">
            <div class="col-md-8 offset-md-2">
                <div id="vcomments"></div>
            </div>
        </div>
    </div>
    

</main>

            <footer id="prism__footer">
                <section>
                    <div>
                        <nav class="social-links">
                            <ul><li><a class="no-link" title="Twitter" href="https://twitter.com/AlanDecode" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-twitter"></i></a></li><li><a class="no-link" title="GitHub" href="https://github.com/AlanDecode" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-github"></i></a></li><li><a class="no-link" title="Weibo" href="https://weibo.com/5245109677/" target="_blank" rel="noopener noreferrer nofollow"><i class="gi gi-weibo"></i></a></li></ul>
                        </nav>
                    </div>

                    <section id="prism__external_links">
                        <ul>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://github.com/AlanDecode/Maverick" rel="noopener noreferrer nofollow">Maverick</a>ï¼šğŸ„â€ Go My Own Way.
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://www.imalan.cn" rel="noopener noreferrer nofollow">ä¸‰ç„¡è¨ˆåŠƒ</a>ï¼šä¸‰æ˜¯è™šæŒ‡ã€‚è‡³äºæ˜¯å“ªä¸‰æ— ï¼Œæˆ‘å””çŸ¥ã€‚
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://wiki.imalan.cn" rel="noopener noreferrer nofollow">ç„¡çŸ¥è­˜</a>ï¼šç†ŠçŒ«å°Açš„Wikiç«™ç‚¹ã€‚éš¶å±äºã€Œä¸‰æ— è®¡åˆ’ã€ã€‚
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://lab.imalan.cn" rel="noopener noreferrer nofollow">ç„¡é …ç›®</a>ï¼šç†ŠçŒ«å°Açš„å®éªŒå®¤ã€‚éš¶å±äºã€Œä¸‰æ— è®¡åˆ’ã€ã€‚
                                <span>|</span>
                            </li>
                            
                            <li>
                                <a class="no-link" target="_blank" href="https://t.me/triple_null" rel="noopener noreferrer nofollow">ç„¡æ¶ˆæ¯</a>ï¼šç†ŠçŒ«å°Açš„å¹¿æ’­ã€‚éš¶å±äºã€Œä¸‰æ— è®¡åˆ’ã€ã€‚
                                <span>|</span>
                            </li>
                            
                        </ul>
                    </section>

                    <div class="copyright">
                        <p class="copyright-text">
                            <span class="brand">æ— æ–‡å­— | ä¸‰æ— è®¡åˆ’</span>
                            <span>Copyright Â© 2020 ç†ŠçŒ«å°A</span>
                        </p>
                        <p class="copyright-text powered-by">
                            | Powered by <a href="https://github.com/AlanDecode/Maverick" class="no-link" target="_blank" rel="noopener noreferrer nofollow">Maverick</a> | Theme <a href="https://github.com/Reedo0910/Maverick-Theme-Prism" target="_blank" class="no-link" rel="noopener noreferrer nofollow">Prism</a>
                        </p>
                    </div>
                    <div class="footer-addon">
                        
<a no-style href="http://beian.miit.gov.cn" target="_blank">äº¬ICPå¤‡18000133å·-1</a> | 
<a no-style href="https://www.upyun.com" target="_blank">åˆæ‹äº‘</a>

                    </div>
                </section>
                <script>
                    var site_build_date = "2017-06-29T12:00+08:00"

                </script>
                <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/prism-a1bd79b1a4.js"></script>
            </footer>
        </div>
    </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    <!--katex-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/katex.min.js"></script>
    <script>
        mathOpts = {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "\\[", right: "\\]", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false }
            ]
        };

    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    
<script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?e4f3a7c02ac2aabc41a1cfa95f61a026";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
</script>
<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<script>
if(window.location.hash){
    var checkExist = setInterval(function() {
       if ($(window.location.hash).length) {
          $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
          clearInterval(checkExist);
       }
    }, 100);
}
</script>
<script>
if(window.navigator && navigator.serviceWorker) {
  caches.keys().then(function(cacheNames) {
    cacheNames.forEach(function(cacheName) {
      caches.delete(cacheName);
    });
  }).then(function(){
    console.log('Cache cleaned.');
  });
  navigator.serviceWorker.getRegistrations()
  .then(function(registrations) {
    for(let registration of registrations) {
      registration.unregister();
    }
  }).then(function(){
    console.log('Service Worker stopped.');
  });
}
</script>

</body>

</html>